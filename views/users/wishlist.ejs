
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="css/tiny-slider.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
		<title>Apollo Furniture </title>
    
  </head>

	<body>

		<!-- Start Header/Navigation -->
		<nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">

			<div class="container">
				<a class="navbar-brand" href="/">Apollo Furniture<span>.</span></a>

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarsFurni">
					<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
						<li>
							<a class="nav-link" href="/">Home</a>
						</li>
						<li><a class="nav-link" href="/shop">Shop</a></li>
						<li ><a class="nav-link" href="/about">About us</a></li>
						<li><a class="nav-link" href="/services">Services</a></li>
						<li><a class="nav-link" href="/blog">Blog</a></li>
						<li><a class="nav-link" href="/contact">Contact us</a></li>
					</ul>

					<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
						<li><a class="nav-link" href="/userProf"><img src="images/user.svg"></a></li>
						<li><a class="nav-link" href="/cart"><img src="images/cart.svg"></a></li>
            <li><a class="nav-link" href="/wishlist"><i class="fa-regular fa-heart" id="wishicon"></i></a></li>
					</ul>
				</div>
			</div>
				
		</nav>
		<!-- End Header/Navigation -->
    
    <!-- Start Hero Section -->
    <div class="hero">
        <div class="container">
            <div class="row justify-content-between">
                <div class="col-lg-5">
                    <div class="intro-excerpt">
                        <h1>Your Wishlist</h1>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
<!-- End Hero Section -->




<div class="untree_co-section before-footer-section">
    <div class="container">
      <div class="row mb-5"  id="reload">
        <form class="col-md-12" method="post">
          <div class="site-blocks-table">
            <table class="table">
              <% if(wishlist.length>0) { %>
              <thead>
                <tr>
                  <th class="product-thumbnail">Image</th>
                  <th class="product-name">Product</th>
                  <th class="product-price">Price</th>
                  
                  <th class="product-remove">Remove</th>
                </tr>
              </thead>
              <tbody>
               
                
                  <% wishlist.forEach((items)=>{ %>
                    <tr>
                      <td class="product-thumbnail">
                        <% if(items.product_id.images.length>0){ %>
                        <img src="<%= items.product_id.images[0] %>" alt="Image" class="img-fluid">
                        <% } %>
                      </td>
                      <td class="product-name">
                        <a href="/productDetails?id=<%= items.product_id._id %>" style="text-decoration: none;"><h2 class="h5 text-black"><%= items.product_id.name %></h2></a>
                      </td>
                      <td>â‚¹<%= items.product_id.price %>.00</td>
                     
                      
                      <td><a href="" class="btn btn-black btn-sm" onclick="dltWishlistItem(event,'<%= items.product_id._id %>')">X</a></td>
                      <% if(items.product_id.quantity>0){ %>
                        <td><a class="btn btn-primary btn-sm" onclick="addToCartWishlist(event,'<%= items.product_id._id %>')"><i class="fa fa-shopping-cart"></i> Add to cart</a></td>
                      <% }else{ %>
                        <td><h5 class="text-danger">Out of stock!</h5></td>
                      <% } %>
                      

                    </tr>
                  <% }) %>
                  <% }else{ %>
                    <h1 >Wishlist is empty!</h1>
                  <% } %>

                
              </tbody>
            </table>
          </div>
        </form>
      </div>

      
    </div>
  </div>


  <script>
   function  dltWishlistItem(event,productId){
      event.preventDefault()
      $.ajax({
        url:'/deleteWishlist',
        method:'post',
        data:{productId}
      }).then((response)=>{
        if(response.success){
          Swal.fire({
  title: "Success!",
  text: "Item has been removed!",
  icon: "success"
}).then(()=>{
    $('#reload').load('/wishlist #reload')
})
        }else{
          Swal.fire({
  icon: "error",
  title: "Oops...",
  text: "Something went wrong!",
});
        }
      })
   }




   function addToCartWishlist(event,productId){
    event.preventDefault()

    $.ajax({
      url:'/wishlistToCart',
      method:'post',
      data:{productId}
    }).then((response)=>{
        if(response.success){
          Swal.fire({
  title: "Success!",
  text: "Item added to cart!",
  icon: "success"
}).then(()=>{
    $('#reload').load('/wishlist #reload')
})
        }else if(!response.success){
          Swal.fire({
  icon: "error",
  title: "Oops...",
  text: response.message,
});
        }else{
          Swal.fire({
  icon: "error",
  title: "Oops...",
  text: 'Something went wrong',
});
        }
      })


   }

  </script>



  <%- include('../partials/footer') -%>