
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="favicon.png">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<!-- Bootstrap CSS -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<link href="css/tiny-slider.css" rel="stylesheet">
		<link href="css/style.css" rel="stylesheet">
        <link href="css/otp.css" rel="stylesheet">
		<title>Apollo Furniture </title>
	</head>

	<body>

		<!-- Start Header/Navigation -->
		<nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">

			<div class="container">
				<a class="navbar-brand" href="/">Apollo Furniture<span>.</span></a>

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarsFurni">
					<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
						<li class="nav-item active">
							<a class="nav-link" href="/">Home</a>
						</li>
						<li><a class="nav-link" href="/shop">Shop</a></li>
						<li><a class="nav-link" href="/about">About us</a></li>
						<li><a class="nav-link" href="/services">Services</a></li>
						<li><a class="nav-link" href="/blog">Blog</a></li>
						<li><a class="nav-link" href="/contact">Contact us</a></li>
					</ul>

					<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
						<li><a class="nav-link" href="/userProf"><img src="images/user.svg"></a></li>
						<li><a class="nav-link" href="/cart"><img src="images/cart.svg"></a></li>
            <li><a class="nav-link" href="/wishlist"><i class="fa-regular fa-heart" id="wishicon"></i></a></li>
					</ul>
				</div>
			</div>
				
		</nav>
		<!-- End Header/Navigation -->
    <div id="wrnmsg">
      <%
      if(typeof message !== 'undefined'){
          %>
          <p style="color:rgb(125, 6, 2)"><%=message%></p>
          <%
      }
      %>
    </div>

        <section class="container-fluid bg-body-tertiary d-block">
            <div class="row justify-content-center">
                <div class="col-12 col-md-6 col-lg-4" style="min-width: 500px;">
                  <div class="card bg-white mb-5 mt-5 border-0" style="box-shadow: 0 12px 15px rgba(0, 0, 0, 0.02);">
                    <div class="card-body p-5 text-center">
                      <h4>Verify</h4>
                      <p>Your code was sent to you via email</p>
                      <p>Time Remaining: <span id="timer"></span> seconds</p>
                        <form action="/otpValidate" method="post" onsubmit="return validateForm(event)">
                      <div class="otp-field mb-4">
                        <input type="hidden" name="email" value="<%= locals.email %>">
                        <input type="text" placeholder="Enter OTP" name="otpv" id="otpin">
                          <br><br>
                          <span id="otpError"></span>
                          <br>
                      <button class="btn btn-primary mb-3" type="submit">
                        Verify
                      </button>
                    </form>
                      
                      <p class="resend text-muted mb-0" style="display: none;" id="resendotp">
                        Didn't receive code? <a href="/send-otp?email=<%= locals.email %>">Request again</a>
                      </p>
                    </div>
                  </div>
                </div>
              </div>
          </section>



<script>

function validateForm(event) {
                event.preventDefault();
    const otpInput = document.getElementById('otpin').value.trim()


    document.getElementById('otpError').innerText = ''

    var isValid = true;

    const otpRegex=/^\d{6}$/

    if (!otpRegex.test(otpInput)) {
                document.getElementById("otpError").innerText = "OTP should be 6 digits";
                isValid = false;
            }

            if (!isValid) {
                return false;
            }

            event.target.submit();

            

}



      function startTimer() {
        var timer = 120; 

        
        var countdown = setInterval(function() {
            document.getElementById('timer').innerText = timer ;
            timer--;

           
            if (timer < 0) {
                clearInterval(countdown);
                document.getElementById('timer').innerText = 'Expired';
                document.getElementById('resendotp').style.display = 'block'
            }
        }, 1000);
    }

    // function checkAndSubmit() {
    //     // Check if the timer has expired
    //     var timerValue = parseInt(document.getElementById('timer').innerText);
    //     if (timerValue <= 0) {
    //         alert('OTP has expired. Please request a new one.');
    //         // If expired, you might want to redirect to the page or handle it appropriately
    //     } else {
    //         // If not expired, proceed with your OTP submission logic
    //         alert('Submitting OTP...');
    //         // Your OTP submission logic goes here
    //     }
    // }

    // Start the timer
    startTimer();
</script>   




        



 <%- include('../partials/footer') -%>